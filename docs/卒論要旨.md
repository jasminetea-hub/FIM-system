# 卒論要旨

## はじめに

リハビリテーション医療において、患者の退院時の機能的自立度を正確に予測することは、適切なリハビリテーション計画の立案と医療資源の効率的な配分において重要な課題である。FIM（Functional Independence Measure：機能的自立度評価法）は、リハビリテーション患者の機能的自立度を客観的に評価する指標として広く用いられている。しかし、従来の予測手法では経験に基づく主観的な判断が多く、予測精度に課題があった。そこで本研究では、機械学習技術を活用したFIM予測システムを開発し、入院時の患者情報とFIM値から退院時のFIM値を高精度に予測することを目的とした。

## システム概要

本システムは、フロントエンド、バックエンド、機械学習APIの3層アーキテクチャで構成されたWebアプリケーションである。フロントエンドはReact 19.2.0とVite 7.2.6を使用し、ユーザーインターフェースを提供する。バックエンドはNode.jsとExpress 5.2.1で実装され、フロントエンドと機械学習APIの間の仲介役を担う。機械学習APIはPythonのFastAPIで実装され、R言語で学習したランダムフォレストモデルを実行する。

システムの主要機能は、入力機能、予測機能、結果表示機能の3つである。入力機能では、ユーザーが個人情報（性別、年齢、BMI、要介護度の有無、発症から入棟までの日数）と入院時FIM値を入力する。入院時FIM値は、運動機能項目12項目（食事、整容、清拭、更衣上半身、更衣下半身、トイレ動作、排尿管理、排便管理、ベッド移乗、トイレ移乗、浴槽移乗、歩行）と認知機能項目5項目（理解、表出、社会的交流、問題解決、記憶）から構成される。各項目は1から7の7段階評価で入力される。

予測機能では、入力されたデータを基に、各FIM項目ごとに個別のランダムフォレストモデルを使用して予測を実行する。本システムでは、合計19個のランダムフォレストモデルを使用し、総合予測モデル1個、運動機能合計モデル1個、認知機能合計モデル1個、運動機能項目モデル12個、認知機能項目モデル5個で構成される。これらのモデルは、R言語の`caret`パッケージを使用して学習され、`.rds`形式で保存される。予測結果は、レーダーチャートと合計点テーブルの形式で表示され、入院時値と予測値を視覚的に比較できる。

## 評価実験

機械学習モデルの評価は、304名の患者データを使用して実施した。データは学習データ（213名、70%）とテストデータ（91名、30%）にランダム分割した。モデルの学習には、10分割交差検証を3回繰り返す（repeatedcv）方法を採用し、合計30回の検証によりモデルの汎化性能を評価した。

各FIM項目について、ランダムフォレストアルゴリズムを使用して予測モデルを構築した。モデルの評価指標として、RMSE（Root Mean Squared Error：平均二乗誤差平方根）、MAE（Mean Absolute Error：平均絶対誤差）、R2（決定係数）、MedAE（中央値絶対誤差）を使用した。テストデータでの予測精度を評価し、各項目の予測性能を検証した。

システムの動作確認として、実際のテストデータを使用した予測実験を実施した。Webアプリケーションを通じて、入院時データを入力し、退院時FIM値の予測が正常に実行されることを確認した。予測結果は、レーダーチャートとテーブルで視覚的に表示され、入院時値と予測値を比較できることを確認した。また、システムの応答時間は数秒以内であり、実用的な速度で予測が実行されることを確認した。

## まとめ

本研究では、機械学習技術を活用したFIM予測システムを開発した。本システムは、入院時の患者情報とFIM値を入力することで、退院時のFIM値を高精度に予測する。ランダムフォレストアルゴリズムを使用した19個の予測モデルにより、各FIM項目ごとに最適化された予測が可能である。Webアプリケーションとして実装することで、医療従事者が容易に利用できるインターフェースを提供した。

本システムにより、リハビリテーション計画の立案や予後予測において、客観的で高精度な予測が可能となる。今後は、より多くのデータを用いたモデルの再学習や、より高度な機械学習アルゴリズムの導入により、予測精度のさらなる向上を目指す。
